SELECT
    op.IdControl,
    op.Libramiento,
    op.codop,
    op.FechaPago,
    op.Cuit,
    prov.NombreP,
    prov.Domicilio,
    op.TipoFactura,
    op.Factura,
    op.MontoBase,
    dop.Porcentaje,
    dop.MontoR,
    ret.Nombre,
    SUM(CASE WHEN dop.CodRetencion = 101 THEN dop.idcontrol ELSE 0 END) as saretId,
    round(SUM(CASE WHEN dop.CodRetencion = 101 THEN dop.Porcentaje ELSE 0 END),1) as saretP,
    round(SUM(CASE WHEN dop.CodRetencion = 101 THEN dop.MontoR ELSE 0 END),2) as SARET,
    SUM(CASE WHEN dop.CodRetencion = 402 THEN dop.idcontrol ELSE 0 END) as ganId,
    round(SUM(CASE WHEN dop.CodRetencion = 402 THEN dop.MontoR ELSE 0 END),2) as Gan,
    SUM(CASE WHEN dop.CodRetencion = 409 THEN dop.idcontrol ELSE 0 END) as ssId,
    round(SUM(CASE WHEN dop.CodRetencion = 409 THEN dop.MontoR ELSE 0 END),2) as SS,
    SUM(CASE WHEN dop.CodRetencion = 133 THEN dop.idcontrol ELSE 0 END) as temId,
    round(SUM(CASE WHEN dop.CodRetencion = 133 THEN dop.Porcentaje ELSE 0 END),1) as temP,
	round(SUM(CASE WHEN dop.CodRetencion = 133 THEN dop.MontoR ELSE 0 END),2) as TEM
FROM
    ordenpago AS `op`
    
INNER JOIN proveedor AS `prov`
ON op.Cuit = prov.Cuit

INNER JOIN detalleordenpago AS `dop`
ON op.CodOP = dop.idcontrol
    
INNER JOIN retencion AS `ret`
ON dop.codretencion = ret.codretencion

WHERE op.IdControl != 0
GROUP BY op.IdControl;